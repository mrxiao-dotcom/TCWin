# -2027æŒä»“é™åˆ¶é”™è¯¯ä¼˜åŒ–è¯´æ˜

## ğŸš¨ é—®é¢˜èƒŒæ™¯

ä»å®é™…ä½¿ç”¨ä¸­å‘ç°ï¼ŒAIOTUSDTç­‰å°å¸ç§åœ¨ä¸‹å•æ—¶é¢‘ç¹é‡åˆ°`-2027`é”™è¯¯ç ï¼š
```
API Error: BadRequest, {"code":-2027,"msg":"Exceeded the maximum allowable position at current leverage."}
```

å³ä½¿æˆ‘ä»¬çš„æŒä»“é™åˆ¶æ£€æŸ¥æ˜¾ç¤º"é€šè¿‡"ï¼Œå¸å®‰APIä»ç„¶æ‹’ç»è®¢å•ã€‚

## ğŸ” é—®é¢˜åˆ†æ

### **åŸæœ‰é—®é¢˜**
1. **ä¼°ç®—ä¸å‡†ç¡®**ï¼šå¯¹å°å¸ç§çš„æŒä»“é™åˆ¶ä¼°ç®—è¿‡äºä¹è§‚
2. **è§„åˆ™è¿‡æ—¶**ï¼šå¸å®‰å®é™…é™åˆ¶æ¯”é¢„è®¾è§„åˆ™æ›´ä¸¥æ ¼
3. **åŠ¨æ€é™åˆ¶**ï¼šæŸäº›å¸ç§çš„é™åˆ¶ä¼šæ ¹æ®å¸‚åœºæƒ…å†µè°ƒæ•´

### **å…·ä½“æ¡ˆä¾‹**
```
é¢„ä¼°ï¼šAIOTUSDT 3xæ æ† â†’ 100000 æŒä»“é™åˆ¶
å®é™…ï¼šä¸‹å•6563å°±è§¦å‘-2027é”™è¯¯
ç»“è®ºï¼šå®é™…é™åˆ¶è¿œå°äºé¢„ä¼°å€¼
```

## âœ… ä¼˜åŒ–æ–¹æ¡ˆ

### **1. ç²¾ç¡®çš„æŒä»“é™åˆ¶è§„åˆ™**

#### **AIOTUSDTä¸“ç”¨è§„åˆ™**
```csharp
"AIOTUSDT" => leverage switch
{
    <= 3 => 50000m,      // 3å€æ æ†ï¼š50000ï¼ˆæ ¹æ®å®é™…é”™è¯¯è°ƒæ•´ï¼‰
    <= 10 => 20000m,     // 10å€æ æ†ï¼š20000
    <= 20 => 10000m,     // 20å€æ æ†ï¼š10000
    <= 50 => 5000m,      // 50å€æ æ†ï¼š5000
    _ => 1000m           // æ›´é«˜æ æ†ï¼š1000
}
```

#### **å°å¸ç§é€šç”¨è§„åˆ™**
```csharp
_ when currentPrice < 1m => leverage switch
{
    <= 3 => 50000m,      // å¯¹å°å¸ç§æ›´ä¿å®ˆ
    <= 10 => 25000m,
    <= 20 => 10000m,
    <= 50 => 5000m,
    _ => 1000m
}
```

### **2. åä¹‰ä»·å€¼é™åˆ¶**

å¯¹äºä»·æ ¼å¾ˆä½çš„å¸ç§ï¼Œå¢åŠ åŸºäºåä¹‰ä»·å€¼çš„äºŒæ¬¡é™åˆ¶ï¼š
```csharp
if (currentPrice > 0 && currentPrice < 1m)
{
    var maxValueLimit = 50000m;  // æœ€å¤§$50000åä¹‰ä»·å€¼
    var valueBasedLimit = maxValueLimit / currentPrice;
    var finalLimit = Math.Min(baseLimit, valueBasedLimit);
    return finalLimit;
}
```

### **3. ç®€åŒ–é”™è¯¯æç¤º**

**ä¼˜åŒ–å‰**ï¼šå†—é•¿çš„æŠ€æœ¯è¯´æ˜ï¼Œç”¨æˆ·éš¾ä»¥ç†è§£
**ä¼˜åŒ–å**ï¼šç›´æ¥çš„è§£å†³æ–¹æ¡ˆ
```
ğŸ› ï¸ ç«‹å³è§£å†³æ–¹æ¡ˆï¼š
   âœ… æ–¹æ¡ˆ1ï¼šé™ä½æ æ†å€æ•°ï¼ˆæ¨èï¼‰
      - å°†æ æ†ä»å½“å‰è®¾ç½®é™ä½åˆ°10å€æˆ–æ›´ä½
   âœ… æ–¹æ¡ˆ2ï¼šå‡å°‘ä¸‹å•æ•°é‡
      - å°è¯•å½“å‰æ•°é‡çš„50%
   âœ… æ–¹æ¡ˆ3ï¼šæ£€æŸ¥ç°æœ‰æŒä»“
      - å¦‚æœ‰åŒåˆçº¦æŒä»“ï¼Œè€ƒè™‘å…ˆéƒ¨åˆ†å¹³ä»“

ğŸ’¡ å°å¸ç§ç‰¹æ®Šæç¤ºï¼š
   â€¢ AIOT/B2ç­‰å°å¸ç§æŒä»“é™åˆ¶è¾ƒä¸¥æ ¼
   â€¢ å»ºè®®æ æ†â‰¤10å€ï¼Œåˆ†æ‰¹å»ºä»“
```

## ğŸ¯ å®é™…æ•ˆæœ

### **é¢„æœŸæ”¹è¿›**
1. **å‡å°‘è¯¯æŠ¥**ï¼šæŒä»“é™åˆ¶æ£€æŸ¥æ›´å‡†ç¡®ï¼Œå‡å°‘é€šè¿‡æ£€æŸ¥ä½†APIæ‹’ç»çš„æƒ…å†µ
2. **æ¸…æ™°æŒ‡å¯¼**ï¼šç”¨æˆ·é‡åˆ°é”™è¯¯æ—¶çŸ¥é“å…·ä½“æ€ä¹ˆåš
3. **é¿å…è¯•é”™**ï¼šæå‰å‘ŠçŸ¥å°å¸ç§çš„ç‰¹æ®Šé™åˆ¶

### **ç”¨æˆ·ä½“éªŒ**
- âœ… æ›´å°‘çš„ä¸‹å•å¤±è´¥
- âœ… æ›´æ˜ç¡®çš„é”™è¯¯æç¤º
- âœ… æ›´å‡†ç¡®çš„å‚æ•°å»ºè®®

## ğŸ”§ æŠ€æœ¯å®ç°

### **æ ¸å¿ƒæ”¹è¿›**
1. **`GetMaxPositionForLeverage`**ï¼šå¢åŠ AIOTUSDTç­‰å…·ä½“å¸ç§çš„é™åˆ¶è§„åˆ™
2. **åä¹‰ä»·å€¼æ£€æŸ¥**ï¼šå¯¹å°å¸ç§å¢åŠ åŸºäºç¾å…ƒä»·å€¼çš„é™åˆ¶
3. **é”™è¯¯ä¿¡æ¯ä¼˜åŒ–**ï¼šç®€åŒ–`GetDetailedPositionLimitError`çš„è¾“å‡º

### **å…¼å®¹æ€§**
- âœ… ä¿æŒåŸæœ‰APIæ¥å£ä¸å˜
- âœ… å‘åå…¼å®¹ç°æœ‰åŠŸèƒ½
- âœ… æ–°å¢çš„é™åˆ¶åªä¼šæ›´ä¸¥æ ¼ï¼Œä¸ä¼šæ”¾æ¾æ£€æŸ¥

## ğŸ“Š ä½¿ç”¨å»ºè®®

### **å¯¹äºAIOTUSDT**
- **æ¨èæ æ†**ï¼šâ‰¤10å€
- **å»ºè®®æ•°é‡**ï¼š<20000ï¼ˆ10å€æ æ†ä¸‹ï¼‰
- **å¼€ä»“ç­–ç•¥**ï¼šåˆ†æ‰¹å»ºä»“ï¼Œé¿å…å¤§å•

### **å¯¹äºå…¶ä»–å°å¸ç§**
- **ä»·æ ¼<$1**ï¼šæ æ†å»ºè®®â‰¤10å€
- **åˆ†æ‰¹ä¸‹å•**ï¼šå¤§ä»“ä½åˆ†å¤šæ¬¡å»ºç«‹
- **ç›‘æ§é™åˆ¶**ï¼šå…³æ³¨å®é™…APIåé¦ˆè°ƒæ•´ç­–ç•¥

è¿™æ¬¡ä¼˜åŒ–è®©æŒä»“é™åˆ¶æ£€æŸ¥æ›´è´´è¿‘å¸å®‰çš„å®é™…è§„åˆ™ï¼Œå‡å°‘äº†ç”¨æˆ·çš„è¯•é”™æˆæœ¬ã€‚ 