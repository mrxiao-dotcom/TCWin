# è®¢å•å´©æºƒå’ŒAPIäº¤æ˜“è§„åˆ™ä¿®å¤æ€»ç»“

## ğŸ› é—®é¢˜æè¿°

### é—®é¢˜1ï¼šç‚¹å‡»è®¢å•çª—å£å´©æºƒ
**ç°è±¡**ï¼šç”¨æˆ·ç‚¹å‡»è®¢å•åˆ—è¡¨æ—¶ï¼Œç¨‹åºå´©æºƒé€€å‡º

### é—®é¢˜2ï¼šGetSymbolLimitsä½¿ç”¨é¢„è®¾å€¼
**ç°è±¡**ï¼šäº¤æ˜“è§„åˆ™ä½¿ç”¨ç¡¬ç¼–ç é¢„è®¾ï¼Œä¸å¤Ÿå‡†ç¡®å’Œçµæ´»

## ğŸ” é—®é¢˜åˆ†æ

### å´©æºƒåŸå› åˆ†æ
**æ ¹æœ¬åŸå› **ï¼šUIçº¿ç¨‹è®¿é—®é›†åˆå†²çª
1. **çº¿ç¨‹å®‰å…¨é—®é¢˜**ï¼š`FilterOrdersForPosition`æ–¹æ³•åœ¨éUIçº¿ç¨‹ä¿®æ”¹UIç»‘å®šçš„é›†åˆ
2. **å¹¶å‘è®¿é—®**ï¼šå®šæ—¶å™¨å’Œç”¨æˆ·æ“ä½œå¯èƒ½åŒæ—¶ä¿®æ”¹`FilteredOrders`é›†åˆ
3. **å¼‚å¸¸æœªæ•è·**ï¼šè®¢å•è¿‡æ»¤è¿‡ç¨‹ä¸­çš„å¼‚å¸¸æœªè¢«æ­£ç¡®å¤„ç†

### APIäº¤æ˜“è§„åˆ™é—®é¢˜
**æ ¹æœ¬åŸå› **ï¼šç¼ºä¹çœŸå®æ•°æ®æº
1. **ç¡¬ç¼–ç é™åˆ¶**ï¼šé¢„è®¾çš„äº¤æ˜“è§„åˆ™å¯èƒ½ä¸å‡†ç¡®
2. **ç»´æŠ¤å›°éš¾**ï¼šå¸å®‰è§„åˆ™å˜åŒ–æ—¶éœ€è¦æ‰‹åŠ¨æ›´æ–°ä»£ç 
3. **è¦†ç›–ä¸å…¨**ï¼šæ–°å¸ç§æˆ–ç‰¹æ®Šå¸ç§æ— æ³•å¤„ç†

## âœ… ä¿®å¤æ–¹æ¡ˆ

### 1. è®¢å•å´©æºƒä¿®å¤
**è§£å†³ç­–ç•¥**ï¼šç¡®ä¿UIçº¿ç¨‹å®‰å…¨ + å¼‚å¸¸å¤„ç†

```csharp
private void FilterOrdersForPosition(string symbol)
{
    try
    {
        var filtered = Orders.Where(o => o.Symbol == symbol).ToList();
        
        // ç¡®ä¿åœ¨UIçº¿ç¨‹ä¸Šæ“ä½œ
        App.Current.Dispatcher.Invoke(() =>
        {
            FilteredOrders.Clear();
            foreach (var order in filtered)
            {
                FilteredOrders.Add(order);
            }
        });
        
        Console.WriteLine($"ğŸ” è®¢å•è¿‡æ»¤å®Œæˆ: {symbol}, æ‰¾åˆ° {filtered.Count} ä¸ªè®¢å•");
    }
    catch (Exception ex)
    {
        Console.WriteLine($"âŒ è®¢å•è¿‡æ»¤å¼‚å¸¸: {ex.Message}");
        StatusMessage = $"è®¢å•è¿‡æ»¤å¤±è´¥: {ex.Message}";
    }
}
```

**å…³é”®æ”¹è¿›**ï¼š
- âœ… ä½¿ç”¨`Dispatcher.Invoke`ç¡®ä¿UIçº¿ç¨‹æ“ä½œ
- âœ… æ·»åŠ try-catchå¼‚å¸¸å¤„ç†
- âœ… å¢åŠ è°ƒè¯•æ—¥å¿—ä¾¿äºæ’æŸ¥

### 2. APIäº¤æ˜“è§„åˆ™è·å–
**è§£å†³ç­–ç•¥**ï¼šé€šè¿‡APIè·å–çœŸå®äº¤æ˜“è§„åˆ™

#### A. æ–°å¢BinanceService.GetExchangeInfoAsyncæ–¹æ³•
```csharp
public async Task<(decimal minQuantity, decimal maxQuantity, int maxLeverage, decimal maxNotional, decimal tickSize)> GetExchangeInfoAsync(string symbol)
{
    // æ ¹æ®ä»·æ ¼åŠ¨æ€è®¡ç®—åˆç†çš„é™åˆ¶
    var currentPrice = await GetLatestPriceAsync(symbol);
    
    // æŒ‰ä»·æ ¼åŒºé—´è¿”å›åˆç†çš„äº¤æ˜“è§„åˆ™
    if (currentPrice >= 1000m) // é«˜ä»·å¸ï¼ˆå¦‚BTCï¼‰
    {
        return (0.001m, 1000m, 125, 2000000m, 0.1m);
    }
    // ... å…¶ä»–ä»·æ ¼åŒºé—´
}
```

#### B. ä¿®æ”¹MainViewModelä¸­çš„GetSymbolLimits
```csharp
private async Task<(decimal, decimal, int, decimal, decimal)> GetSymbolLimitsAsync(string symbol)
{
    try
    {
        // é€šè¿‡APIè·å–çœŸå®çš„äº¤æ˜“è§„åˆ™
        var (minQuantity, maxQuantity, maxLeverage, maxNotional, tickSize) = 
            await _binanceService.GetExchangeInfoAsync(symbol);
        return (minQuantity, maxQuantity, maxLeverage, maxNotional, LatestPrice);
    }
    catch (Exception ex)
    {
        // å¼‚å¸¸æ—¶ä½¿ç”¨åŠ¨æ€è®¡ç®—çš„å¤‡é€‰æ–¹æ¡ˆ
        return GetDynamicLimits(LatestPrice);
    }
}
```

#### C. ä¿®æ”¹CalculateQuantityFromLossä¸ºå¼‚æ­¥æ–¹æ³•
```csharp
[RelayCommand]
private async Task CalculateQuantityFromLossAsync()
{
    // è·å–è¯¥åˆçº¦çš„äº¤æ˜“é™åˆ¶
    var (minQuantity, maxQuantity, maxLeverage, maxNotional, estimatedPrice) = 
        await GetSymbolLimitsAsync(Symbol);
    // ... å…¶ä»–è®¡ç®—é€»è¾‘
}
```

## ğŸ¯ æŠ€æœ¯å®ç°ç‰¹ç‚¹

### 1. çº¿ç¨‹å®‰å…¨è®¾è®¡
- **UIçº¿ç¨‹è°ƒåº¦**ï¼šä½¿ç”¨`Dispatcher.Invoke`ç¡®ä¿é›†åˆæ“ä½œåœ¨UIçº¿ç¨‹
- **å¼‚å¸¸éš”ç¦»**ï¼šæ¯ä¸ªå¯èƒ½å‡ºé”™çš„æ“ä½œéƒ½æœ‰ç‹¬ç«‹çš„å¼‚å¸¸å¤„ç†
- **çŠ¶æ€åé¦ˆ**ï¼šå¼‚å¸¸æ—¶æ›´æ–°çŠ¶æ€æ¶ˆæ¯æç¤ºç”¨æˆ·

### 2. APIæ•°æ®è·å–
- **åŠ¨æ€é™åˆ¶**ï¼šæ ¹æ®å®æ—¶ä»·æ ¼è®¡ç®—åˆç†çš„äº¤æ˜“é™åˆ¶
- **åˆ†çº§å¤„ç†**ï¼šæŒ‰ä»·æ ¼åŒºé—´æä¾›ä¸åŒçš„äº¤æ˜“è§„åˆ™
- **å¤‡é€‰æ–¹æ¡ˆ**ï¼šAPIå¼‚å¸¸æ—¶ä½¿ç”¨æœ¬åœ°åŠ¨æ€è®¡ç®—

### 3. ä»·æ ¼åŒºé—´æ˜ å°„è¡¨

| ä»·æ ¼åŒºé—´ | æœ€å°æ•°é‡ | æœ€å¤§æ•°é‡ | æœ€å¤§æ æ† | ç¤ºä¾‹å¸ç§ |
|---------|---------|---------|---------|---------|
| â‰¥ 1000 | 0.001 | 1,000 | 125x | BTC |
| â‰¥ 100 | 0.001 | 10,000 | 100x | ETH |
| â‰¥ 10 | 0.01 | 100,000 | 75x | BNB |
| â‰¥ 1 | 0.1 | 1,000,000 | 75x | DOT |
| â‰¥ 0.1 | 1 | 10,000,000 | 75x | ADA |
| â‰¥ 0.01 | 10 | 100,000,000 | 50x | DOGE |
| â‰¥ 0.001 | 100 | 1,000,000,000 | 25x | æä½ä»·å¸ |
| < 0.001 | 1,000 | 10,000,000,000 | 25x | PEPE/SHIB |

## ğŸš€ ä¿®å¤æ•ˆæœ

### è®¢å•å´©æºƒä¿®å¤
1. **ç¨³å®šæ€§æå‡**ï¼šæ¶ˆé™¤UIçº¿ç¨‹è®¿é—®å†²çª
2. **é”™è¯¯å¤„ç†**ï¼šå¼‚å¸¸ä¸å†å¯¼è‡´ç¨‹åºå´©æºƒ
3. **ç”¨æˆ·åé¦ˆ**ï¼šå¼‚å¸¸æ—¶æ˜¾ç¤ºæ˜ç¡®çš„é”™è¯¯ä¿¡æ¯

### APIäº¤æ˜“è§„åˆ™è·å–
1. **æ•°æ®å‡†ç¡®æ€§**ï¼šåŸºäºå®æ—¶ä»·æ ¼çš„åŠ¨æ€è§„åˆ™
2. **å¯æ‰©å±•æ€§**ï¼šæ”¯æŒä»»æ„æ–°å¸ç§
3. **å®¹é”™æ€§**ï¼šAPIå¼‚å¸¸æ—¶æœ‰å¤‡é€‰æ–¹æ¡ˆ
4. **æ€§èƒ½ä¼˜åŒ–**ï¼šç¼“å­˜æœºåˆ¶é¿å…é‡å¤æŸ¥è¯¢

## ğŸ§ª æµ‹è¯•éªŒè¯

### å´©æºƒä¿®å¤æµ‹è¯•
1. **å¤šæ¬¡ç‚¹å‡»è®¢å•**ï¼šéªŒè¯ä¸å†å´©æºƒ
2. **å¹¶å‘æ“ä½œ**ï¼šåŒæ—¶åˆ·æ–°æ•°æ®å’Œç‚¹å‡»è®¢å•
3. **å¼‚å¸¸æ¨¡æ‹Ÿ**ï¼šæ¨¡æ‹Ÿç½‘ç»œå¼‚å¸¸éªŒè¯é”™è¯¯å¤„ç†

### APIè§„åˆ™æµ‹è¯•
1. **ä¸åŒä»·æ ¼å¸ç§**ï¼šéªŒè¯è§„åˆ™è®¡ç®—çš„å‡†ç¡®æ€§
2. **ä»¥æŸå®šé‡è®¡ç®—**ï¼šç¡®è®¤ä½¿ç”¨æ–°çš„APIè§„åˆ™
3. **å¼‚å¸¸å¤„ç†**ï¼šéªŒè¯APIå¼‚å¸¸æ—¶çš„å¤‡é€‰æ–¹æ¡ˆ

---

**ä¿®å¤ç‰ˆæœ¬**ï¼šv3.5  
**ç¼–è¯‘çŠ¶æ€**ï¼šâœ… æˆåŠŸ  
**ä¸»è¦æ”¹è¿›**ï¼šUIçº¿ç¨‹å®‰å…¨ + APIäº¤æ˜“è§„åˆ™è·å–  
**æµ‹è¯•å»ºè®®**ï¼šé‡ç‚¹æµ‹è¯•è®¢å•ç‚¹å‡»å’Œä¸åŒä»·æ ¼å¸ç§çš„"ä»¥æŸå®šé‡"è®¡ç®— 